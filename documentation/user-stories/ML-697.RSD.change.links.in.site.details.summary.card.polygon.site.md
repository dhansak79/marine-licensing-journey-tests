# ML-697: RSD - Change links in "Site details" summary card (polygon site)

## User Story

AS an applicant

I WANT to be able to change answers from the "Review site details" page for a polygon site

SO THAT I can ensure that my sites are correct

## Background

This story covers the ability to make changes to the answers given in the "Site details" summary card(s) of the "Review site details" page, specifically for polygon sites.

Some of these change links are simple 'bounce' links, where the user is taken to a data page (for example the "Site name" page), where they can make any necessary changes and then they get immediately returned to the "Review site details" page.

However, there are other more complex change links, which have mini flows associated with them. For example, if you select the option to change the coordinate system for a site from OSGB36 to WGS84, you will be taken through to the coordinate list page next, so that you can enter a set of appropriate WGS84 coordinates. The pages involved in each of these mini flows is different per change link.

## Resources

Link to "Change link routing" in Mural

Link to "Review site details" page for manually entered sites

## Out of scope

Change links in other summary cards.

Change links for file upload sites and circular sites.

## Questions and answers

Q. In the scenario where the user selects the "Change" option against the "Single or multiple sets of coordinates" or "Coordinate system" question but keeps their answer the same, should we just redirect them straight back to the "Review site details" page?

A. Yes, this would represent a simpler flow for the user, and is also considered to be easier from a development point of view. Story has been updated to reflect this flow.

## Screenshots

### Review site details page - polygon site

![Review site details page showing a polygon site with multiple coordinate sets. The page displays three main sections: "Providing the site location" (showing method as manual entry and multiple sites), "Activity details" (showing matching dates and descriptions across sites with change links), and "Site 1 details" card with a pink border. The site details show: site name "Barryshingles pier samples", coordinate entry method as "Enter multiple sets of coordinates to mark the boundary of the site", coordinate system as "WGS84 (World Geodetic System 1984) Latitude and longitude", three coordinate points listed (Start and end points: 55.019889, 1.399500; Point 2: 1.399500, 55.019889; Point 3: 55.019889, -1.399500), and a map view displaying a triangular boundary shape on a light blue background. Each editable field has an associated "Change" link on the right side.]

## Acceptance criteria

### SITE NAME

**AC1 - change link for "Site name"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the "Site name" field for a polygon site

THEN I am taken to the "Site name" page

AND the page is pre-populated with the answer I previously provided

AND I am able to -

- save changes to my answer (returns me to the specific site anchor on the "Review site details" page with changes saved)

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present on the "Site name" page

NOTE - this is the same behaviour as for a circular site (see https://eaflood.atlassian.net/browse/ML-723)

### ACTIVITY DATES

**AC2 - change link for "Activity dates"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the "Activity dates" field for a polygon site

THEN I am taken to the "Activity dates" page

AND the page is pre-populated with the answers I previously provided

AND I am able to -

- save changes to my answer (returns me to the specific site anchor on the "Review site details" page with changes saved)

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present on the "Activity dates" page

NOTE - this is the same behaviour as for a circular site (see https://eaflood.atlassian.net/browse/ML-723)

### ACTIVITY DESCRIPTION

**AC3 - change link for "Activity description"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the "Activity description" field for a polygon site

THEN I am taken to the "Activity description" page

AND the page is pre-populated with the answers I previously provided

AND I am able to -

- save changes to my answer via "Save and continue" (returns me to the specific site anchor on the "Review site details" page with changes saved)

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present on the "Activity description" page

NOTE - this is the same behaviour as for a circular site (see https://eaflood.atlassian.net/browse/ML-723)

### SINGLE OR MULTIPLE SETS OF COORDINATES

**AC4 - change link for "Single or multiple sets of coordinates"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the "Single or multiple sets of coordinates" field for a polygon site

THEN I am taken to the "How do you want to enter the site coordinates?" page

AND the page is pre-populated with the answer I previously provided (i.e. polygon site)

AND I am able to -

- Keep my answer as multiple sets of coordinates (polygon site) - SEE AC5a

- Change my answer to single set of coordinates (circular site) - SEE AC5b

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present

NOTE - the navigation here is not a simple 'bounce' change, there is a mini flow that the user will go through as shown in the diagram above. This is because changes to one thing e.g. the coordinate system has a knock-on effect on the data entered after that point.

**AC5a - remaining flow - keep answer as "multiple sets of coordinates"**

GIVEN I am viewing the "How do you want to enter the site coordinates?" page following the scenario from AC4

AND I chose to keep the answer as multiple sets of coordinates (polygon site)

WHEN I select the "Continue" option

THEN I am returned to the "Review site details" page (anchor for the specific site I was editing)

**AC5b - remaining flow - change answer to "single set of coordinates"**

GIVEN I am viewing the "Which coordinate system do you want to use?" following the scenario from AC4

AND I chose to change the answer to a single set of coordinates (circular site)

WHEN I select the "Continue" option

THEN I am taken forward through the remaining pages of the flow to define a circular site -

- from the How do you want to enter the site coordinates?" page, then

- the "Which coordinate system do you want to use?" page, then

- the "Enter the coordinates at the centre point of the site" page, then

- the "Enter the width of the circular site in metres" page, then

- the "Review site details" page (anchor for the specific site I was editing)

AND I can make changes on each page as necessary

AND I can navigate forwards through this flow using the "Continue" button ("Save and continue" on last page before the "Review site details" page)

AND I can navigate backwards through this flow using the "Back" link (all the way back to the specific site anchor on the "Review site details" page)

AND I am NOT able to cancel out of any of these pages as the "Cancel" option will not be present

AND no previous data is pre-populated in any page (since the previous data relates to a polygon site and is not appropriate to a circular site)

### COORDINATE SYSTEM

**AC6 - change link for "Coordinate system"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the "Coordinate system" field for a polygon site

THEN I am taken to the "Which coordinate system do you want to use?" page

AND the page is pre-populated with the answer I previously provided

AND I am able to -

- Keep my answer the same as it was previously - SEE AC7a

- Change my answer to the other coordinate system - SEE AC7b

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present

NOTE - the navigation here is not a simple 'bounce' change, there is a mini flow that the user will go through as per the diagram above. This is because changes to one thing e.g. the coordinate system has a knock-on effect on the data entered after that point.

**AC7a - remaining flow - keeping coordinate system the same**

GIVEN I am viewing the "Which coordinate system do you want to use?" page following the scenario from AC6

AND I chose to keep my answer the same as it was previously

WHEN I select the "Continue" option

THEN I am returned to the "Review site details" page (anchor for the specific site I was editing)

**AC7b - remaining flow - changing to the other coordinate system**

GIVEN I am viewing the "Which coordinate system do you want to use?" page following the scenario from AC6

AND I chose to change my answer to the other coordinate system

WHEN I select the "Continue" option

THEN I am taken forward through the remaining pages of the flow to define a polygon site -

- from the "Which coordinate system do you want to use?" page, then

- the "Enter multiple sets of coordinates to mark the boundary of the site" page, then

- the "Review site details" page (anchor for the specific site I was editing)

AND I can make changes on each page as necessary

AND I can navigate forwards through this flow using the "Continue" button ("Save and continue" on last page before the "Review site details" page)

AND I can navigate backwards through this flow using the "Back" link (all the way back to the specific site anchor on the "Review site details" page)

AND I am NOT able to cancel out of any of these pages as the "Cancel" option will not be present

AND my previous data is pre-populated in each page where appropriate (i.e. if I change the coordinate system then it does not make sense to default in the coordinates on the next page, since the old coordinates would be of the wrong type)

### LIST OF COORDINATES

**AC8 - change "list of coordinates"**

GIVEN I am viewing the "Review site details" page

WHEN I select the change link against the list of coordinates for a polygon site

THEN I am taken to the "Enter multiple sets of coordinates to mark the boundary of the site" page

AND the page is pre-populated with the answers I previously provided

AND I am able to -

- save changes to my answers via "Save and continue" button (returns me straight back to the specific site anchor on the "Review site details" page with changes saved)

- select 'back' (returns me to the specific site anchor on the "Review site details" page without saving any changes)

AND I am NOT able to cancel out of making the change as the "Cancel" option will not be present

**AC9 - link styling**

GIVEN I am viewing the "Review site details" page

WHEN I view any "Change", "Add", "Delete site" or "Delete all site details" links as defined in the previous ACs

THEN these links should have the govuk-link--no-visited-state class so they always remain blue

NOTE - these are navigational links rather than linking to content pages etc so the styling should not change once they have been clicked

**AC10 - return user to anchor on site details summary card**

GIVEN I have amended an answer as per the previous ACs

WHEN I return to the "Review site details" page

THEN I am returned to the anchor for the specific site that I was amending

NOTE - this ensure that the user is returned to the correct point on the page, which will make things easier if they have a long list of sites
