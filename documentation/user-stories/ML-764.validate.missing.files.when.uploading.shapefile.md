# ML-764: Validate for missing files when uploading Shapefile

## User Story

AS an applicant

I WANT to see meaningful content and error messages when I provide an invalid shapefile

SO THAT I can understand how to provide a valid shapefile

## Background

The initial implementation of file upload did not have any validation which looked inside the zip file provided and verified that the required files were present. This story defines the validation that should be performed on the shapefile to ensure that it contains the right information:

- shapefile must contain .shp .shx and .dbf files
- shapefile must contain .prj file
- .prj file must be less than 50KB

The guidance content on the page will also be updated to reflect the above requirements.

## Resources

https://defra-digital.slack.com/archives/C09KA2KRZEG/p1759845648817199

## Screenshots

### File upload page - shapefile version

The upload page displays:

- Page heading: "Upload a shapefile"
- Project name shown above the heading
- Body text guidance explaining:
  - "Upload a ZIP file containing all the files for your shapefile. Your shapefile must include .shp, .shx, .dbf and .prj files."
  - "You can include more than one site."
- File upload widget with "No file chosen" status
- "Choose file" button with "or drop file" text
- "Continue" button (green) and "Cancel" link

## Acceptance Criteria

### AC1 - validate that .shp .shx and .dbf files have been provided

GIVEN I have a shapefile that does not contain .shp .shx and .dbf files

WHEN I upload the shapefile

THEN I see the following error on the upload page - "The selected file must include .shp .shx and .dbf files"

### AC2 - validate that .prj file has been provided

GIVEN I have a shapefile that contains .shp .shx and .dbf files (i.e. the validation from AC1 has passed)

AND the shapefile does not contain a .prj file

WHEN I upload the shapefile

THEN I see the following error on the upload page - "The selected file must include a .prj file"

### AC3 - validate that .prj file is less than 50kb

GIVEN I have a shapefile that contains all the necessary files (i.e. the validation from AC1 and AC2 has passed)

AND the .prj file is greater than 50kb

WHEN I upload the shapefile

THEN I see the following error on the upload page - "The selected file's .prj file must be smaller than 50KB"

### AC4 - update upload page guidance content

GIVEN I am uploading a shapefile

WHEN I view the content on the "File upload" page

THEN I see the guidance content as shown in the above screenshot

AND this guidance will not be displayed if I have selected to upload a KML file

**NOTE** - the content on the page is now body text not hint text

## Technical Notes

- Validation should occur in order: AC1 → AC2 → AC3
- Error messages must be displayed using GOV.UK error summary and error message components
- The .prj file size validation only applies after confirming the file exists
- The updated guidance is specific to shapefile uploads and should not appear for KML uploads
